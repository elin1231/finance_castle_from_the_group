#!/usr/bin/env python3
"""
Crawl news headlines from Reuters and save as csv.
Input file: ./input/tickerList.csv
News append to: ./input/news_reuters.csv
"""
import os
import sys
import time
import datetime

# import util from parent directory
# credit: https://stackoverflow.com/a/11158224/4246348
import inspect

currentdir = os.path.dirname(os.path.abspath(inspect.getfile(inspect.currentframe())))
parentdir = os.path.dirname(currentdir)
sys.path.insert(0, parentdir)
import util


class ReutersCrawler(object):
    def __init__(self):
        self.ticker_list_filename = "./input/tickerList.csv"
        self.finished_reuters_filename = "./input/finished.reuters"
        self.failed_reuters_filename = "./input/news_failed_tickers.csv"
        self.news_filename = "./input/news_reuters.csv"

    def load_finished_tickers(self):
        # when we restart a task, we may call calc_finished_ticker() in crawler/yahoo_finance.py
        # so that we can load the already finished reuters if any
        return set(self._load_from_file(self.finished_reuters_filename))

    def load_failed_tickers(self):
        failed_tickers = {}  # {ticker: priority}
        for line in self._load_from_file(self.failed_reuters_filename):
            ticker, _, priority = line.split(",")
            failed_tickers[ticker] = priority
        return failed_tickers

    def _load_from_file(self, filename):
        if os.path.exists(filename):
            with open(filename, "r") as f:
                for line in f:
                    yield line.strip()

    def fetch_content(self, task, date_range):
        # https://uk.reuters.com/info/disclaimer
        ticker, name, exchange, market_cap = task
        print("%s - %s - %s - %s" % (ticker, name, exchange, market_cap))

        suffix = {"AMEX": ".A", "NASDAQ": ".O", "NYSE": ".N"}
        # e.g. https://www.reuters.com/finance/stocks/company-news/BIDU.O?date=09262017
        url = (
            "https://www.reuters.com/finance/stocks/company-news/"
            + ticker
            + suffix[exchange]
        )

        ticker_failed = open(self.failed_reuters_filename, "a+")
        today = datetime.datetime.today().strftime("%Y%m%d")

        news_num = self.get_news_num_whenever(url)
        if news_num:
            # this company has news, then fetch for N consecutive days in the past
            has_content, no_news_days = self.fetch_within_date_range(
                news_num, url, date_range, task, ticker
            )
            if not has_content:
                print("%s has no content within date range" % ticker)
            if no_news_days:
                print("set as LOW priority")
                for timestamp in no_news_days:
                    ticker_failed.write(ticker + "," + timestamp + "," + "LOW\n")
        else:
            # this company has no news even if we don't set a date
            # add it into the lowest priority list
            print("%s has no news at all, set as LOWEST priority" % (ticker))
            ticker_failed.write(ticker + "," + today + "," + "LOWEST\n")
        ticker_failed.close()

    def get_news_num_whenever(self, url):
        # check the website to see if the ticker has any news
        # return the number of news
        soup = util.get_soup_with_repeat(url, repeat_times=4)
        if soup:
            return len(soup.find_all("div", {"class": ["topStory", "feature"]}))  #<div class="News-container--3JD6"><h3 class="TextLabel__text-label___3oCVw TextLabel__black___2FN-Z TextLabel__medium___t9PWg News-title-2NUw9">Latest News</h3><div class="FeedScroll-container-2mXNY News-feeds-1qtII"><div class="FeedScroll-new-feeds-indicator-container-2qUhr"><div class="StickyContainer-container-3Q8GJ FeedScroll-new-feeds-indicator-2IGpd FeedScroll-hidden-1Bd1F"><div></div><div style="height: calc(100% - 37px);"></div><div class="StickyContainer-content-1u-cE"><button class="FeedScroll-new-feeds-button-3eHBP"><p class="TextLabel__text-label___3oCVw TextLabel__orange___bulJg TextLabel__small-all-caps___2Z2RG FeedScroll-new-feeds-text-2gs4u">New Stories</p></button></div></div></div><div class="FeedScroll-feed-container-106s7"><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu NewsFeed-first-2kYZX"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-mozambique-internet/alphabets-loon-and-s-africas-vodacom-to-expand-rural-internet-in-mozambique-idUSKBN22P1Z1">Alphabet's Loon and S.Africa's Vodacom to expand rural internet in Mozambique</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Loon, a unit of Google's owner Alphabet Inc , which uses high-altitude balloons to provide mobile internet to remote areas, has signed a deal with Vodacom to expand the South African mobile operator's network in Mozambique.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">6 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-waymo-funding/waymo-extends-external-funding-round-to-3-billion-idUSKBN22O2PM">Waymo extends external funding round to $3 billion</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Waymo, the self-driving unit of Alphabet Inc &lt;GOOGL.O&gt;, said on Tuesday it raised an additional $750 million in its first external investment round, bringing the total funding to $3 billion.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">7 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-healthcare-coronavirus-alphabet/google-announces-company-holiday-on-may-22-to-stem-virus-burnout-idUSKBN22K2XD">Google announces company holiday on May 22 to stem virus burnout</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Alphabet Inc's Google said on Friday it has asked employees to take a day off on May 22, to address work-from-home-related burnout during the coronavirus pandemic.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">11 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-eu-tech-disinformation/eu-should-beef-up-fake-news-pledge-involving-google-facebook-twitter-study-idUSKBN22K2TG">EU should beef up fake news pledge involving Google, Facebook, Twitter: study</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">The European Union should strengthen a voluntary pledge, to which Facebook Inc, Alphabet Inc's Google and Twitter Inc signed up to combat fake news, with sanctions to make it a more effective tool, a study done for the European Commission said on Friday.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">11 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-canada-sidewalk/alphabets-sidewalk-labs-cancels-toronto-smart-city-project-idUSKBN22J2FN">Alphabet's Sidewalk Labs cancels Toronto 'smart city' project</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Alphabet's &lt;GOOGL.O&gt; Sidewalk Labs has pulled the plug on its Toronto "smart city" project, citing "unprecedented economic uncertainty" in a setback for the city's long-planned waterfront revitalization.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">12 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/lime-funding/uber-leads-170-mln-investment-round-for-bike-sharing-startup-lime-idUSL4N2CP3RL">Uber leads $170 mln investment round for bike-sharing startup Lime</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Bike-sharing service provider Lime said on Thursday it raised $170 million in an investment round led by Uber Technologies Inc, with Alphabet Inc, Bain Capital Ventures and GV among other participants.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">12 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-health-coronavirus-usa-apps/apple-google-ban-use-of-location-tracking-in-contact-tracing-apps-idUSKBN22G28W">Apple, Google ban use of location tracking in contact tracing apps</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Apple Inc and Alphabet Inc's Google on Monday said they would ban the use of location tracking in apps that use a new contact tracing system the two are building to help slow the spread of the novel coronavirus.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">14 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-fitbit-m-a-alphabet-concern/u-s-consumer-advocates-urge-close-scrutiny-of-google-plan-to-buy-fitbit-idUSKBN22C30Y">U.S. consumer advocates urge close scrutiny of Google plan to buy Fitbit</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">The Justice Department should carefully scrutinize Alphabet Inc's plan to buy Fitbit because the fitness tracker company is a source of nascent competition for Google, which is dominant in search and advertising, two public advocacy groups said on Thursday.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">19 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-health-coronavirus-apple-alphabet/apple-google-to-release-early-versions-of-contact-tracing-tool-to-developers-idUSKBN22B2S9">Apple, Google to release early versions of contact tracing tool to developers</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Apple Inc and Alphabet Inc's Google would release two early versions this week of their proposed technology to slow coronavirus spread to select developers for testing purposes, the companies said on Wednesday.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">20 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/usa-stocks/us-stocks-snapshot-wall-st-jumps-on-hopes-of-potential-coronavirus-drug-idUSL4N2CH1RC">US STOCKS SNAPSHOT-Wall St jumps on hopes of potential coronavirus drug</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">U.S. stocks opened higher on Wednesday after Gilead Sciences gave an encouraging update on a potential COVID-19 treatment, while upbeat earnings reports from Boeing and Google-parent Alphabet added to the sentiment.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">20 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/usa-stocks/us-stocks-futures-rise-on-alphabet-boeing-earnings-ahead-of-gdp-data-idUSL4N2CH190">US STOCKS-Futures rise on Alphabet, Boeing earnings ahead of GDP data</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">* Futures up: Dow 0.54%, S&amp;P 500 0.53%, Nasdaq 0.71% (Adds comments, updates price action)</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">20 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/usa-stocks/us-stocks-alphabet-earnings-drive-futures-higher-ahead-of-gdp-data-idUSL4N2CH08P">US STOCKS-Alphabet earnings drive futures higher ahead of GDP data</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">U.S. stock index futures rose on Wednesday after Google-parent Alphabet reported upbeat quarterly results, while investors braced for data that could show a sharp contraction in the domestic economy.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">20 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-alphabet-results/alphabet-warns-of-difficult-quarter-as-consumers-google-pandemic-not-shopping-idUSKCN22A37K">Alphabet warns of difficult quarter as consumers Google pandemic, not shopping</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Alphabet Inc &lt;GOOGL.O&gt; on Tuesday beat analysts' estimate for quarterly revenue as its Google unit posted double-digit advertising growth despite the economic slowdown from the novel coronavirus.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">21 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/alphabet-results/google-parent-alphabet-quarterly-revenue-beats-estimates-idUSL3N2CG4VL">Google parent Alphabet quarterly revenue beats estimates</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Google parent Alphabet Inc beat Wall Street estimates for first-quarter revenue on Tuesday, recording 13% growth even as companies drastically slashed spending during the coronavirus crisis.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">21 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-apple-google-contact-tracing/apple-google-update-coronavirus-contact-tracing-tech-ahead-of-launch-idUSKCN2262NT">Apple, Google update coronavirus contact tracing tech ahead of launch</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Apple Inc &lt;AAPL.O&gt; and Alphabet Inc's &lt;GOOGL.O&gt; Google on Friday updated technical details of the coronavirus contact tracing system they plan to release next month, saying new features would strengthen privacy protections and give health authorities more detailed data.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">25 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-australia-media-ireland/ireland-should-consider-forcing-google-facebook-to-pay-media-for-content-pm-idUSKCN2262I4">Ireland should consider forcing Google, Facebook to pay media for content: PM</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">The Irish government should consider copying Australia's plan to force Facebook Inc &lt;FB.O&gt; and Alphabet Inc's &lt;GOOGL.O&gt; Google to share advertising revenue with local media, Prime Minister Leo Varadkar said on Friday.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">25 days ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-google-advertising/google-to-make-verification-mandatory-for-all-advertisers-idUSKCN2252GN">Google to make verification mandatory for all advertisers</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Alphabet Inc's Google said on Thursday all advertisers would have to complete a verification process before buying ad space on its platform, starting this summer, in a bid to make its ad practices more transparent.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">a month ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/google-advertising/google-to-make-verification-mandatory-for-all-advertisers-idUSL3N2CB3LM">Google to make verification mandatory for all advertisers</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Alphabet Inc's Google said on Thursday all advertisers would have to complete a verification process before buying ad space on its platform, starting this summer, in a bid to make its ad practices more transparent.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">a month ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/us-health-coronavirus-alphabet/google-says-state-backed-hackers-increasing-coronavirus-phishing-attacks-idUSKCN2242U2">Google says state-backed hackers increasing coronavirus phishing attacks</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Security experts at Alphabet Inc's &lt;GOOGL.O&gt; Google have identified more than a dozen government-backed hacking groups using the COVID-19 pandemic as cover for phishing and malware attempts.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">a month ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div><div class="item"><div class="MarketStoryItem-container-3rpwz NewsFeed-story-1bEiu"><a class="TextLabel__text-label___3oCVw TextLabel__black-to-orange___23uc0 TextLabel__medium___t9PWg MarketStoryItem-headline-2cgfz" href="https://www.reuters.com/article/google-lawsuit-fraud/ripple-sues-youtube-over-cryptocurrency-scams-idUSL5N2C93E8">Ripple sues YouTube over cryptocurrency scams</a><p class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__serif___3lOpX MarketStoryItem-description-3kmoG">Blockchain firm Ripple sued Alphabet Inc's YouTube on Tuesday, alleging the video-sharing platform failed to protect consumers from cryptocurrency "giveaway" scams that use fake social media profiles to dupe victims into sending money.</p><div class="MarketStoryItem-footer-1SCZA"><time class="TextLabel__text-label___3oCVw TextLabel__gray___1V4fk TextLabel__regular___2X0ym MarketStoryItem-date-H-tta">a month ago</time><div class="SocialTools__container___3rfoZ share"><button type="button" class="SocialTools__icon___MYRE6 SocialTools__facebook___3tojW SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 16"><path d="M5.8 16V8.7h2.7l.4-2.8H5.8V4c0-.8.2-1.4 1.5-1.4H9V.1C8.7.1 7.8 0 6.6 0c-2.3 0-4 1.3-4 3.8v2.1H0v2.8h2.7V16h3.1z"></path></svg></button><button type="button" class="SocialTools__icon___MYRE6 SocialTools__twitter___1EoE2 SocialTools__gray-to-original___1Duya SocialTools__borderless___368d9" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M512.002 97.211c-18.84 8.354-39.082 14.001-60.33 16.54 21.686-13 38.342-33.585 46.186-58.115a210.29 210.29 0 0 1-66.705 25.49c-19.16-20.415-46.461-33.17-76.674-33.17-58.011 0-105.042 47.029-105.042 105.039 0 8.233.929 16.25 2.72 23.939-87.3-4.382-164.701-46.2-216.509-109.753-9.042 15.514-14.223 33.558-14.223 52.809 0 36.444 18.544 68.596 46.73 87.433a104.614 104.614 0 0 1-47.577-13.139c-.01.438-.01.878-.01 1.321 0 50.894 36.209 93.348 84.261 103a105.245 105.245 0 0 1-27.674 3.687c-6.769 0-13.349-.66-19.764-1.888 13.368 41.73 52.16 72.104 98.126 72.949-35.95 28.176-81.243 44.967-130.458 44.967-8.479 0-16.84-.496-25.058-1.471 46.486 29.807 101.701 47.197 161.021 47.197 193.211 0 298.868-160.062 298.868-298.872 0-4.554-.104-9.084-.305-13.59 20.526-14.809 38.335-33.309 52.417-54.373z"></path></svg></button></div></div></div></div></div><div><div class="FeedScroll-loading-indicator-2x-vj"></div></div></div></div>
        return 0

    def fetch_within_date_range(self, news_num, url, date_range, task, ticker):
        # if it doesn't have a single news for X consecutive days, stop iterating dates
        # set this ticker into the second-lowest priority list
        missing_days = 0
        has_content = False
        no_news_days = []
        for timestamp in date_range:
            print(
                "trying " + timestamp, end="\r", flush=True
            )  # print timestamp on the same line
            new_time = (
                timestamp[4:] + timestamp[:4]
            )  # change 20151231 to 12312015 to match reuters format
            soup = util.get_soup_with_repeat(url + "?date=" + new_time)
            if soup and self.parse_and_save_news(soup, task, ticker, timestamp):
                missing_days = 0  # if get news, reset missing_days as 0
                has_content = True
            else:
                missing_days += 1

            # the more news_num, the longer we can wait
            # e.g., if news_num is 2, we can wait up to 30 days; 10 news, wait up to 70 days
            if missing_days > news_num * 5 + 20:
                # no news in X consecutive days, stop crawling
                print(
                    "%s has no news for %d days, stop this candidate ..."
                    % (ticker, missing_days)
                )
                break
            if missing_days > 0 and missing_days % 20 == 0:
                no_news_days.append(timestamp)

        return has_content, no_news_days

    def parse_and_save_news(self, soup, task, ticker, timestamp):
        content = soup.find_all("div", {"class": ["topStory", "feature"]})
        if not content:
            return False
        with open(self.news_filename, "a+", newline="\n") as fout:
            for i in range(len(content)):
                title = content[i].h2.get_text().replace(",", " ").replace("\n", " ")
                body = content[i].p.get_text().replace(",", " ").replace("\n", " ")

                if i == 0 and soup.find_all("div", class_="topStory"):
                    news_type = "topStory"
                else:
                    news_type = "normal"

                print(ticker, timestamp, title, news_type)
                # fout.write(','.join([ticker, task[1], timestamp, title, body, news_type]).encode('utf-8') + '\n')
                fout.write(
                    ",".join([ticker, task[1], timestamp, title, body, news_type])
                    + "\n"
                )
        return True

    def run(self, numdays=1000):
        """Start crawler back to numdays"""
        finished_tickers = self.load_finished_tickers()
        failed_tickers = self.load_failed_tickers()
        date_range = util.generate_past_n_days(numdays)  # look back on the past X days

        # store low-priority task and run later
        delayed_tasks = {"LOWEST": set(), "LOW": set()}
        with open(self.ticker_list_filename) as ticker_list:
            for line in ticker_list:  # iterate all possible tickers
                task = tuple(line.strip().split(","))
                ticker, name, exchange, market_cap = task
                if ticker in finished_tickers:
                    continue
                if ticker in failed_tickers:
                    priority = failed_tickers[ticker]
                    delayed_tasks[priority].add(task)
                    continue
                self.fetch_content(task, date_range)

        # run task with low priority
        for task in delayed_tasks["LOW"]:
            self.fetch_content(task, date_range)
        # run task with lowest priority
        for task in delayed_tasks["LOWEST"]:
            self.fetch_content(task, date_range)


def main():
    reuter_crawler = ReutersCrawler()
    reuter_crawler.run(1)


if __name__ == "__main__":
    main()
